# Инструкция по деплою и обновлению

Проект настроен для работы через Docker Compose. Фронтенд и бэкенд собираются в один контейнер, где FastAPI раздает статику.

## Требования
- Docker
- Docker Compose V2

---

## Первичная установка на VPS
```bash
# Клонирование репозитория
git clone https://github.com/qqForest/DnD-Lite.git
cd DnD-Lite

# Запуск сборки
sudo docker compose up -d --build
```

---

## Обновление приложения
Если вы внесли изменения в код и запушили их в GitHub, выполните эти команды на VPS для применения изменений:

### 1. Быстрое обновление (одной строкой)
```bash
git pull origin main && sudo docker compose up -d --build
```

### 2. Пошаговое обновление
```bash
# Подтянуть изменения из репозитория
git pull origin main

# Пересобрать образ и перезапустить контейнеры
# Смарт-сборка: пересоберет только то, что изменилось
sudo docker compose up -d --build

# Очистка старых неиспользуемых образов (чтобы не забивать диск)
sudo docker image prune -f
```

---

## Полезные команды

### Просмотр логов
```bash
# Все логи в реальном времени
sudo docker compose logs -f

# Логи только бэкенда
sudo docker compose logs -f app
```

### Статус контейнера
```bash
sudo docker compose ps
```

### Остановка проекта
```bash
sudo docker compose down
```

### Данные (База данных)
Файл базы данных `dnd_lite.db` проброшен из контейнера в корень папки проекта на хосте. 
При обновлении контейнера **данные сохраняются**.

Чтобы сделать бэкап, достаточно просто скопировать файл:
```bash
cp dnd_lite.db dnd_lite.db.bak
```
